# surface
lam = 0.2
lsh = -0.5 + lam
wsh = 99.9987499921874
b_0 = 0
i_0 = -1/sqrt(0.1)
c1 = 1.0000125002343799000000E-01*b_0 -5.0000625011718995000000E-03*i_0
c2 = 0.0000000000000000000000E00*b_0  +1.0000000000000000000000E00*i_0


d1(t) = exp(lsh*t)*(cos(wsh*t)*c1 + sin(wsh*t)*c2)
d2(t) = exp(lsh*t)*(-sin(wsh*t)*c1 + cos(wsh*t)*c2)
b0(t) = 9.9998749992187400000000E00*d1(t) + 4.9999999999999996000000E-02*d2(t)
i0(t) = 0.0000000000000000000000E00*d1(t) + 1.0000000000000000000000E00*d2(t)

lof0 = -0.5000062500780547 + lam
lof1 = -0.2499968749606154 + lam
wof1 = 141.42025138417293
f0(a,b,i) = -7.0710682521498440000000E-01*a -7.0712450332756500000000E-01*b +3.5355783208034390000000E-02*i
f1(a,b,i) =  7.0634755689641640000000E-02*a -7.0297604050184160000000E-02*b -6.7077992598633850000000E-01*i
f2(a,b,i) = -4.7306808792917210000000E-02*a +4.7804487804357090000000E-02*b -9.9773583517261420000000E-01*i
af(k0,k1,k2) = -7.0709789799243980000000E-01*k0 +4.8694325957360580000000E00*k1  -3.2987866328186515000000E00*k2
bf(k0,k1,k2) = -7.0711557588182860000000E-01*k0 -4.8925754637035690000000E00*k1  +3.2642315406645697000000E00*k2
if(k0,k1,k2) = -3.5355336841314670000000E-04*k0 -4.6529789194419496000000E-01*k1 -6.8946106813664640000000E-01*k2


n0(t) = f0(0.0, b0(t), i0(t))
n1(t) = f1(0.0, b0(t), i0(t))
n2(t) = f2(0.0, b0(t), i0(t))

p0(t1,t2) = exp(lof0*t2)*n0(t1)
p1(t1,t2) = exp(lof1*t2)*(cos(wof1*t2)*n1(t1) + sin(wof1*t2)*n2(t1))
p2(t1,t2) = exp(lof1*t2)*(-sin(wof1*t2)*n1(t1) + cos(wof1*t2)*n2(t1))

ap(t1,t2) = af(p0(t1,t2), p1(t1,t2), p2(t1,t2))
bp(t1,t2) = bf(p0(t1,t2), p1(t1,t2), p2(t1,t2))
ip(t1,t2) = if(p0(t1,t2), p1(t1,t2), p2(t1,t2))


set parametric
set urange [0:0.005]
set vrange [0.02:0.025]
set xrange [0.95:1.0]
set zrange [-0.01:0.01]

set cntrparam levels discrete -0.01,0.0,0.01
#set isosamples 100,100
set contour both
#set view 90,20
splot ip(u,v-u)*sqrt(0.1),bp(u,v-u)*sqrt(1e-3),ap(u,v-u)*sqrt(1e-3)
