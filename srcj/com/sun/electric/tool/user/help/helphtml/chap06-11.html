<!-- HEADER 6-11: Interpretive Languages -->

<!-- COMMAND Tools/Languages/Run Java Bean Shell Script... -->
<!-- COMMAND Tools/Languages/Manage Java Bean Shell Scripts... -->

Electric has the Bean Shell built into it.
This enables you to load custom Java code that adds functionality to Electric.
<P>
The Bean Shell is not part of the default Electric distribution.
You must add it as a "plug in"
(see <A HREF="chap01-05.html#chap01-05">Section 1-5</A> for more on plug-ins).
<P>
To run a script, use the <B>Run Java Bean Shell Script...</B> command
(in menu <B>Tools / Languages</B>).
<P>
<TABLE><TR><TD>
You can attach a script to the <B>Tools / Languages</B> menu by using the
<B>Manage Java Bean Shell Scripts...</B> command.
Scripts can have mnemonic letters assigned to them
(see <A HREF="chap01-09.html#chap01-09">Section 1-9</A> for more on mnemonics).
</TD><TD><CENTER><IMG SRC="fig06-30.png" ALT="Figure 6.30"></CENTER></TD></TR></TABLE>
<P>
Here are some example scripts in the Java Bean Shell.

<TABLE WIDTH="100%"><TR>
<TD WIDTH="75%"><TABLE WIDTH="100%" BORDER=1><TR><TD>
<CODE><FONT SIZE="-1">
import com.sun.electric.database.hierarchy.Cell;<BR>
import com.sun.electric.database.topology.NodeInst;<BR>
import com.sun.electric.technology.PrimitiveNode;<BR>
import java.awt.geom.Point2D;<BR>
<BR>
Cell newCell = Cell.makeInstance(Library.getCurrent(), "theCell{lay}");<BR>
PrimitiveNode trP = (PrimitiveNode)Cell.findNodeProto("mocmos:P-Transistor");<BR>
NodeInst tP = NodeInst.makeInstance(trP, new Point2D.Double(10, 10),<BR>
&nbsp;&nbsp;&nbsp;trP.getDefWidth(), trP.getDefHeight(), newCell);
</FONT></CODE>
</TD></TR></TABLE></TD>
<TD VALIGN=TOP>
This initial example creates a new cell and places a transistor in it.
</TD></TR></TABLE>


<TABLE WIDTH="100%"><TR>
<TD WIDTH="75%"><TABLE WIDTH="100%" BORDER=1><TR><TD>
<CODE><FONT SIZE="-1">
import com.sun.electric.database.hierarchy.Cell;<BR>
import com.sun.electric.database.geometry.Orientation;<BR>
import com.sun.electric.database.topology.ArcInst;<BR>
import com.sun.electric.database.topology.NodeInst;<BR>
import com.sun.electric.technology.ArcProto;<BR>
import com.sun.electric.technology.PrimitiveNode;<BR>
import com.sun.electric.technology.Technology;<BR>
import java.awt.geom.Point2D;<BR>
<BR>
// create the new cell<BR>
Cell newCell = Cell.makeInstance(Library.getCurrent(), "exampleCell{lay}");<BR>
<BR>
Technology tech = Technology.findTechnology("mocmos");<BR>
<BR>
// place a rotated transistor<BR>
PrimitiveNode trP = tech.findNodeProto("P-Transistor");<BR>
NodeInst tP = NodeInst.makeInstance(trP, new Point2D.Double(0, 20), trP.getDefWidth(), trP.getDefHeight(), newCell, Orientation.R, "T1");<BR>
<BR>
// place a metal-Active contact<BR>
PrimitiveNode coP = tech.findNodeProto("Metal-1-P-Active-Con");<BR>
NodeInst maP = NodeInst.makeInstance(coP, new Point2D.Double(8, 20), coP.getDefWidth(), coP.getDefHeight(), newCell);<BR>
<BR>
// wire the transistor to the contact<BR>
ArcProto aP = tech.findArcProto("P-Active");<BR>
ArcInst.makeInstance(aP, tP.findPortInst("diff-bottom"), maP.findPortInst("metal-1-p-act"));<BR>
<BR>
// export the contact<BR>
com.sun.electric.database.hierarchy.Export.newInstance(newCell, maP.findPortInst("metal-1-p-act"), "IN", PortCharacteristic.IN);
</FONT></CODE>
</TD></TR></TABLE></TD>
<TD VALIGN=TOP>
This example goes a bit further: it creates a rotated transistor and a contact, wires them together,
and exports the contact.
The transistor is named "T1."
</TD></TR></TABLE>


<TABLE WIDTH="100%"><TR>
<TD WIDTH="75%"><TABLE WIDTH="100%" BORDER=1><TR><TD>
<CODE><FONT SIZE="-1">
import com.sun.electric.database.hierarchy.Cell;<BR>
import com.sun.electric.tool.Job;<BR>
import java.util.Iterator;<BR>
<BR>
// get the current cell<BR>
Cell lay =  Job.getUserInterface().getCurrentCell();<BR>
<BR>
// find all exports<BR>
String aOut = "Exports that start with 'a':";<BR>
<BR>
for(Iterator it = lay.getPorts(); it.hasNext(); ) {<BR>
&nbsp;&nbsp;&nbsp;com.sun.electric.database.hierarchy.Export e =
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(com.sun.electric.database.hierarchy.Export)it.next();<BR>
&nbsp;&nbsp;&nbsp;if (e.getName().toLowerCase().startsWith("a")) aOut += " " + e.getName();<BR>
}<BR>
System.out.println(aOut);
</FONT></CODE>
</TD></TR></TABLE></TD>
<TD VALIGN=TOP>
This example  searches the current cell for exports starting with "a".
</TD></TR></TABLE>

<P>
Notice that Electric's "Export" object must be a fully-qualified name, because the
name "Export" is used for other reasons in the Bean Shell.
This also applies to Electric's "EPoint" class.
<P>
For more information about accessing the internals of Electric, read the Javadoc
in the source code.

<!-- TRAILER -->
