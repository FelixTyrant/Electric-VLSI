<!-- HEADER 8-4-3: Spice -->

SPICE circuit simulation is a special case in Electric.
Because the simulator is not interactive, all specifications must be done graphically, in advance.
Note that the example shown here is available in the "samples.txt" library as cell "tool-SimulateSPICE"
(you can read the library with the <B>Readable Dump</B>
subcommand of the <B>Import</B> command of the <B>File</B> menu).
<P>
<TABLE><TR><TD>
All input values to SPICE are controlled with special nodes,
found in the <B>New SPICE Part</B> command of the <B>Edit</B> menu.
These parts are also available from the "Spice" button in the component menu of the Schematics technologies.
Note that the first time any SPICE node is placed, the library of SPICE parts is loaded into Electric.
</TD><TD><CENTER><IMG SRC="fig09-06.png" ALT="Figure 9.6"></CENTER></TD></TR></TABLE>
<P>
The SPICE primitives described here are for Electric's default set.
However, additional sets can (and have) been written.
To choose another set, change the "SPICE primitive set" popup in the <B>SPICE Options...</B>
subcommand of the <B>Simulation (SPICE)</B> command of the <B>Tools</B> menu.
<P>
In this example, there is a 5-volt supply on the left.
It was created by using the <B>DC Voltage Source</B> subcommand.
Once placed, the text that reads "Voltage=0V" is selected and modified
(either with <B>Get Info</B> or by double-clicking on it).
The Pulse input signal on the right is created with the <B>Pulse</B> subcommand (it has 7 parameters).
<P>
This example also shows the ability to add arbitrary text to the SPICE deck with
the <B>Add SPICE Card</B> subcommand of the <B>Simulation (SPICE)</B> command of the <B>Tools</B> menu.
The command creates a piece of text (shown in the lower-right) that can be modified arbitrarily.
<P>
There are both voltage and current sources, in AC and DC form.
The pulse input sources are available as voltage and current.
A set of "two-gate" devices are also available: <B>CCCS</B>, <B>CCVS</B>, <B>VCCS</B>, <B>VCVS</B>,
and <B>Transmission</B>.
<P>
It is possible to specify Transient, DC, or AC analysis by using the <B>Transient Analysis</B>,
<B>DC Analysis</B>, and <B>AC Analysis</B> subcommands.
Only one such element may exist in a circuit.
<P>
Bipolar transistors have their substrate connected to ground by default.
If a <B>Substrate</B> node is encountered,
its network will be used for the substrate connection of these transistors instead.
The <B>Well</B> subcommand can be used to specify the well network.
<P>
For advanced users, there are two special SPICE nodes: <B>Node Set</B> and <B>Extension</B>.
The Node Set may be parameterized with an arbitrary piece of SPICE code.
Truly advanced users may create their own SPICE nodes by modifying the cells in the SPICE library.
<P>
Another option that can be used when modeling transistors and other component is to set a specific SPICE model to use for that component.
Use the <B>Set Spice Model...</B> subcommand of the <B>Simulation (SPICE)</B> command of the <B>Tools</B>
menu to create a SPICE model field on the selected component.
Then you can select that text and set it.
<P>
The <B>Add Multiplier</B> subcommand places a multiplier on the currently selected node.
Multipliers (also called "M" factors) scale the size of transistors inside of them.
<P>
<!-- NEED 7in -->
<TABLE><TR>
<TD><CENTER><IMG SRC="fig09-03.png" ALT="Figure 9.3"></CENTER></TD><TD>
Some nongraphical information can also be given to the SPICE simulator with the <B>SPICE Options...</B>
subcommand of the <B>Simulation (SPICE)</B> command of the <B>Tools</B> menu.
<P>
The top part of this dialog allows you to control many of the SPICE deck parameters such as the SPICE format
(SPICE 2, SPICE 3, HSPICE, PSPICE, Gnucap, or SmartSPICE),
the SPICE level (1, 2, or 3),
what format to expect when reading SPICE output,
whether to use parasitics in the deck,
whether to use actual node names in the deck (SPICE 2 cannot handle this),
and whether to force power and ground to be global signal names.
</TD></TR></TABLE>
<P>
When "Use Cell Parameters" is checked, any parameters defined on the cell will appear in the SPICE deck.
When this is not checked, each parameterized cell appears multiple times in the deck,
once for each different parameter combination.
See <A HREF="chap06-08.html#chap06-08">Section 6-8</A> for more on parameters.
<P>
The "Write Trans Sizes in Lambda" dialog requests that the SPICE deck contain scalable size information
instead of absolute size information.
<P>
UNIX systems can choose to run SPICE after the deck has been generated.
In addition, they can specify special command-line options to be given to SPICE (the "With" field).
There are five options:
<UL>
<LI>"Don't Run SPICE" requests deck generation only.
<LI>"Run SPICE" causes SPICE to be run after deck generation,
and the output shown in the messages window.
<LI>"Run SPICE Quietly", causes SPICE to be run after deck generation, but the output is ignored.
<LI>"Run SPICE, Read Output" causes SPICE to be run after deck generation,
output to be shown in the messages window, and the output to be examined for waveform values
(which are then shown in a waveform window).
<LI>"Run SPICE Quietly, Read Output" causes SPICE to be run after deck generation, output to be not shown,
and the output to be examined for waveform values (which are then shown in a waveform window).
</UL>
Note that SPICE 2 and SPICE 3 place their waveform values in the output,
but HSPICE writes waveform values to a disk file (.tr0 file).
Therefore, it does not make sense to choose "Run SPICE, Read Output" or
"Run SPICE Quietly, Read Output" when using HSPICE.
<P>
The middle section of the Spice Options dialog controls technology-specific information.
The upper-middle section controls parasitics, including per-layer resistance, capacitance, and edge-capacitance.
You can also set the minimum resistance and capacitance for the entire technology.
The lower-middle section controls header cards
(placed at the start of the SPICE deck) and trailer cards (placed at the end of the SPICE deck).
This dialog allows you to specify a disk file with header cards or trailer cards to be used instead of the built-in set.
You can specify a particular file or request that the system search for files with the cell's name and a given extension.
You can also edit the built-in header cards for the current technology by using the "Edit Built-in Header Cards" button,
which invokes an editing window (see <A HREF="chap04-10.html#chap04-10">Section 4-10</A> for more on text editing).
<P>
Note that the header, trailer, and parasitic information is specific to a particular technology.
If you set this information for one technology, but then use another technology when generating the SPICE deck,
the information that you set will not be used.
Note also that schematics, although a technology in Electric, are not considered to be SPICE technology.
You can set the proper layout technology that you want to use when dealing with schematics by using the
<B>Technology Options</B> command of the <B>Technology</B> menu and setting the
"Use Lambda values from this Technology" popup.
<P>
The bottom section of the dialog allows you to specify a disk file of SPICE cards that will be used to describe any cell.
This disk file replaces the any SPICE description that may be derived from the circuitry.

<!-- TRAILER -->
